<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>DEX-CEX Arbitrage</title>
<style>
body { font-family: Arial; margin: 20px; }
table { border-collapse: collapse; width: 100%; margin-bottom: 30px; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
th { background: #eee; }
.profit-pos { color: green; font-weight: bold; }
.profit-neg { color: red; font-weight: bold; }
.tables { display: flex; gap: 20px; }
.tables table { width: 50%; }
</style>
</head>
<body>
<h1>üìä Arbitrage Monitor</h1>
<div class="tables">
<table id="odos-mexc">
  <thead>
    <tr>
      <th>–¢–æ–∫–µ–Ω</th>
      <th>ODOS —Ü–µ–Ω–∞</th>
      <th>MEXC —Ü–µ–Ω–∞</th>
      <th>–°–ø—Ä–µ–¥ (%)</th>
      <th>–ü—Ä–∏–±—ã–ª—å (USDT)</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
</div>

<script>
async function loadData() {
  const res = await fetch("/prices");
  const data = await res.json();
  const tbody = document.querySelector("#odos-mexc tbody");
  tbody.innerHTML = "";
  for (const token of Object.keys(data.odos)) {
    const row = document.createElement("tr");
    const odos = data.odos[token] ? data.odos[token].toFixed(6) : "-";
    const mexc = data.mexc[token] ? data.mexc[token].toFixed(6) : "-";
    const spread = data.spread[token] ? data.spread[token].toFixed(2) : "-";
    let profit = "-";
    if (data.profit[token] != null) {
      profit = data.profit[token].toFixed(4);
      profit = data.profit[token] > 0 ? `<span class="profit-pos">+${profit}</span>` :
               data.profit[token] < 0 ? `<span class="profit-neg">${profit}</span>` : profit;
    }
    row.innerHTML = `<td>${token}</td><td>${odos}</td><td>${mexc}</td><td>${spread}</td><td>${profit}</td>`;
    tbody.appendChild(row);
  }
}

setInterval(loadData, 10000); // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
loadData();
</script>
</body>
</html>
